describe('Stats', () => {
  let map;

  beforeEach(() => {
    map = L.map('map', {
      center: L.latLng(44.96777356135154, 6.06822967529297),
      zoom: 13,
    });
  });

  afterEach(async () => {
    sinon.restore();
    await map.removeAsPromise();
    L.TrackStats.cache.clear();
  });

  describe('Compute stats', () => {
    it('computing stats when no data available should fail gracefully', () => {
      const latlngs = [
        [44.988659, 6.078873],
        [44.988783, 6.078814],
        [44.988776, 6.078788],
        [44.988662, 6.078523],
        [44.988601, 6.078367],
        [44.98856, 6.078209],
        [44.988528, 6.078066],
        [44.988495, 6.077877],
        [44.988452, 6.07774],
        [44.988452, 6.077597],
        [44.988399, 6.0774],
        [44.988384, 6.077257],
        [44.988384, 6.077257],
        [44.988387, 6.077104],
        [44.988296, 6.076986],
        [44.988296, 6.076986],
        [44.988138, 6.076772],
        [44.988051, 6.076738],
        [44.987886, 6.076694],
        [44.987797, 6.076617],
        [44.987455, 6.076065],
        [44.98714, 6.075665],
        [44.987076, 6.075617],
        [44.986941, 6.07559],
        [44.986822, 6.075589],
        [44.986709, 6.075583],
        [44.986644, 6.07554],
        [44.986605, 6.075479],
        [44.986604, 6.075404],
        [44.986617, 6.075305],
        [44.986646, 6.07516],
        [44.986608, 6.075112],
        [44.986531, 6.075139],
        [44.986459, 6.075183],
        [44.986395, 6.075186],
        [44.986326, 6.075151],
        [44.986223, 6.075099],
        [44.986137, 6.075136],
        [44.986053, 6.07512],
        [44.985962, 6.075062],
        [44.985963, 6.074984],
        [44.985996, 6.074816],
        [44.98605, 6.074631],
        [44.986079, 6.07444],
        [44.986159, 6.074302],
        [44.98618, 6.07422],
        [44.986173, 6.07417],
        [44.986074, 6.074137],
        [44.985933, 6.074105],
        [44.985776, 6.074119],
        [44.985611, 6.074127],
        [44.985504, 6.074084],
        [44.985341, 6.073989],
        [44.985208, 6.073925],
        [44.985137, 6.073942],
        [44.984934, 6.073841],
        [44.984875, 6.073739],
        [44.984834, 6.07364],
        [44.984784, 6.073599],
        [44.984741, 6.073569],
        [44.984661, 6.073512],
        [44.984592, 6.073445],
        [44.984452, 6.073332],
        [44.98439, 6.073235],
        [44.984293, 6.073115],
        [44.984175, 6.072909],
        [44.984121, 6.072805],
        [44.984057, 6.072655],
        [44.984022, 6.072627],
        [44.983982, 6.072643],
        [44.983982, 6.072643],
        [44.983725, 6.072784],
        [44.983431, 6.072764],
        [44.983277, 6.072734],
        [44.982906, 6.072492],
        [44.982647, 6.072236],
        [44.982378, 6.072277],
        [44.982096, 6.072278],
        [44.981775, 6.072218],
        [44.98145, 6.071838],
        [44.981358, 6.071794],
        [44.981374, 6.071727],
        [44.981374, 6.071727],
        [44.981358, 6.071794],
        [44.981214, 6.071723],
        [44.980984, 6.071471],
        [44.980921, 6.071268],
        [44.980837, 6.071243],
        [44.980683, 6.071212],
        [44.980645, 6.071071],
        [44.980682, 6.070816],
        [44.980638, 6.070686],
        [44.980605, 6.070593],
        [44.980638, 6.070551],
        [44.980693, 6.07048],
        [44.980672, 6.070281],
        [44.98064, 6.070261],
        [44.980548, 6.070212],
        [44.980467, 6.070262],
        [44.980467, 6.070262],
        [44.98045, 6.070338],
        [44.980411, 6.070402],
        [44.980331, 6.070399],
        [44.980291, 6.070342],
        [44.980245, 6.070309],
        [44.980174, 6.070209],
        [44.980104, 6.070201],
        [44.979989, 6.07027],
        [44.98, 6.070178],
        [44.98005, 6.070046],
        [44.980108, 6.069985],
        [44.980183, 6.069863],
        [44.98005, 6.069831],
        [44.979979, 6.069787],
        [44.979822, 6.069786],
        [44.979784, 6.069851],
        [44.979709, 6.070115],
        [44.979581, 6.070435],
        [44.979509, 6.070456],
        [44.979419, 6.070392],
        [44.979462, 6.070274],
        [44.979379, 6.070251],
        [44.979227, 6.070143],
        [44.979159, 6.070109],
        [44.979147, 6.070069],
        [44.979177, 6.069979],
        [44.979276, 6.06987],
        [44.979264, 6.069589],
        [44.979276, 6.069288],
        [44.979315, 6.06905],
        [44.979319, 6.068836],
        [44.979298, 6.068682],
        [44.979357, 6.068402],
        [44.979468, 6.068332],
        [44.97947, 6.068271],
        [44.979417, 6.068192],
        [44.979325, 6.068002],
        [44.979214, 6.06778],
        [44.979109, 6.067836],
        [44.979054, 6.067761],
        [44.979003, 6.067763],
        [44.978906, 6.067936],
        [44.978835, 6.068022],
        [44.978702, 6.068178],
        [44.978726, 6.068023],
        [44.978692, 6.068028],
        [44.978631, 6.068138],
        [44.978541, 6.068199],
        [44.978369, 6.068284],
        [44.978254, 6.068334],
        [44.978238, 6.068307],
        [44.978296, 6.068113],
        [44.978362, 6.068045],
        [44.978349, 6.067966],
        [44.978389, 6.06786],
        [44.978367, 6.06776],
        [44.978375, 6.067607],
        [44.978424, 6.067578],
        [44.978433, 6.067472],
        [44.978442, 6.067362],
        [44.978337, 6.06738],
        [44.978219, 6.067456],
        [44.978279, 6.067312],
        [44.978298, 6.067195],
        [44.978203, 6.067279],
        [44.978069, 6.067378],
        [44.978103, 6.067197],
        [44.977984, 6.067244],
        [44.977853, 6.067285],
        [44.977885, 6.067183],
        [44.977807, 6.067237],
        [44.977804, 6.067187],
        [44.977858, 6.067082],
        [44.977813, 6.06704],
        [44.977818, 6.066994],
        [44.977894, 6.066842],
        [44.977815, 6.06689],
        [44.977713, 6.066982],
        [44.977618, 6.067008],
        [44.977671, 6.066894],
        [44.977749, 6.066731],
        [44.977686, 6.066733],
        [44.977689, 6.066617],
        [44.977547, 6.066594],
        [44.97765, 6.066341],
        [44.977717, 6.066186],
        [44.977648, 6.066183],
        [44.977531, 6.066086],
        [44.977477, 6.06599],
        [44.977379, 6.065902],
        [44.977221, 6.06581],
        [44.977138, 6.065813],
        [44.977097, 6.065723],
        [44.977107, 6.065641],
        [44.977029, 6.065404],
        [44.976968, 6.065249],
        [44.976842, 6.0651],
        [44.9768, 6.064991],
        [44.976725, 6.064889],
        [44.976621, 6.064892],
        [44.976575, 6.064803],
        [44.976457, 6.064724],
        [44.976296, 6.064604],
        [44.976294, 6.064555],
        [44.976333, 6.064507],
        [44.976365, 6.064445],
        [44.976303, 6.064387],
        [44.976208, 6.064319],
        [44.97612, 6.064193],
        [44.975944, 6.063992],
        [44.975771, 6.063872],
        [44.975657, 6.063788],
        [44.97555, 6.063767],
        [44.975451, 6.063792],
        [44.975334, 6.06385],
        [44.975254, 6.063883],
        [44.975193, 6.063838],
        [44.975069, 6.063854],
        [44.975053, 6.063949],
        [44.975087, 6.064024],
        [44.975055, 6.064145],
        [44.97501, 6.064177],
        [44.974937, 6.064222],
        [44.974864, 6.064369],
        [44.974813, 6.06437],
        [44.974757, 6.064421],
        [44.974692, 6.064539],
        [44.974597, 6.064628],
        [44.974552, 6.064708],
        [44.974529, 6.06472],
        [44.974409, 6.064664],
        [44.97435, 6.064853],
        [44.974306, 6.064943],
        [44.974242, 6.065017],
        [44.974186, 6.065151],
        [44.974146, 6.065141],
        [44.974126, 6.065209],
        [44.974131, 6.065307],
        [44.974113, 6.065486],
        [44.974099, 6.065606],
        [44.97407, 6.065664],
        [44.974031, 6.065718],
        [44.974031, 6.065718],
        [44.974029, 6.065621],
        [44.974025, 6.065415],
        [44.974004, 6.065298],
        [44.973972, 6.065209],
        [44.973881, 6.065076],
        [44.97384, 6.064986],
        [44.973834, 6.064855],
        [44.973838, 6.064699],
        [44.973827, 6.064528],
        [44.973864, 6.064409],
        [44.973884, 6.064262],
        [44.973938, 6.064217],
        [44.973969, 6.064083],
        [44.973992, 6.063936],
        [44.973989, 6.063856],
        [44.973907, 6.063761],
        [44.973834, 6.063747],
        [44.973771, 6.063837],
        [44.973699, 6.063823],
        [44.973635, 6.063774],
        [44.973582, 6.063668],
        [44.973515, 6.063533],
        [44.973453, 6.063388],
        [44.973372, 6.063233],
        [44.973326, 6.06306],
        [44.97328, 6.062876],
        [44.973229, 6.062672],
        [44.97323, 6.062637],
        [44.973087, 6.062629],
        [44.973087, 6.062629],
        [44.97323, 6.062637],
        [44.973233, 6.062508],
        [44.973177, 6.06243],
        [44.97308, 6.062236],
        [44.972912, 6.061966],
        [44.972793, 6.061768],
        [44.972697, 6.061564],
        [44.972605, 6.061363],
        [44.972515, 6.061171],
        [44.972445, 6.061008],
        [44.972372, 6.060892],
        [44.972277, 6.060741],
        [44.972173, 6.060688],
        [44.972136, 6.060637],
        [44.972046, 6.060604],
        [44.972004, 6.060548],
        [44.971938, 6.060539],
        [44.971803, 6.060486],
        [44.971705, 6.060396],
        [44.971616, 6.060404],
        [44.971568, 6.060367],
        [44.971489, 6.060384],
        [44.971468, 6.060249],
        [44.971427, 6.060088],
        [44.97136, 6.059991],
        [44.971324, 6.059906],
        [44.971243, 6.059834],
        [44.971175, 6.059816],
        [44.971104, 6.05989],
        [44.971056, 6.060039],
        [44.97102, 6.060092],
        [44.970971, 6.060036],
        [44.970989, 6.059941],
        [44.970943, 6.059911],
        [44.970954, 6.059757],
        [44.970896, 6.059745],
        [44.970831, 6.059659],
        [44.970788, 6.059709],
        [44.970739, 6.059725],
        [44.970683, 6.05973],
        [44.970584, 6.05969],
        [44.970472, 6.059596],
        [44.970464, 6.059507],
        [44.97053, 6.059451],
        [44.97054, 6.0594],
        [44.97059, 6.059341],
        [44.9706, 6.059257],
        [44.970625, 6.059188],
        [44.970612, 6.059058],
        [44.970588, 6.058958],
        [44.970586, 6.058859],
        [44.97053, 6.058748],
        [44.970423, 6.05864],
        [44.970333, 6.058554],
        [44.97019, 6.058507],
        [44.970078, 6.0585],
        [44.969988, 6.058488],
        [44.969918, 6.058526],
        [44.969839, 6.058497],
        [44.969762, 6.058442],
        [44.96967, 6.058391],
        [44.969571, 6.058359],
        [44.969513, 6.058365],
        [44.969414, 6.058345],
        [44.969285, 6.058363],
        [44.969198, 6.058373],
        [44.969179, 6.058326],
        [44.969198, 6.058282],
        [44.969249, 6.05822],
        [44.969263, 6.058105],
        [44.969156, 6.058095],
        [44.969064, 6.058094],
        [44.96896, 6.058074],
        [44.968909, 6.058049],
        [44.96905, 6.058012],
        [44.969083, 6.057976],
        [44.969171, 6.057931],
        [44.969275, 6.057887],
        [44.969365, 6.057878],
        [44.969453, 6.05779],
        [44.969573, 6.057761],
        [44.969573, 6.057761],
        [44.96954, 6.057719],
        [44.969419, 6.057673],
        [44.969369, 6.057627],
        [44.969284, 6.057595],
        [44.969244, 6.057489],
        [44.969166, 6.057436],
        [44.969109, 6.05742],
        [44.969088, 6.057377],
        [44.969126, 6.057353],
        [44.969104, 6.05729],
        [44.969033, 6.057279],
        [44.9689, 6.057223],
        [44.968798, 6.057122],
        [44.968753, 6.057065],
        [44.968706, 6.057013],
        [44.968622, 6.057076],
        [44.968593, 6.057025],
        [44.968532, 6.057027],
        [44.968482, 6.056943],
        [44.968419, 6.056929],
        [44.968296, 6.056803],
        [44.968222, 6.056696],
        [44.968131, 6.056623],
        [44.968073, 6.056635],
        [44.967995, 6.05659],
        [44.967888, 6.056494],
        [44.967822, 6.056419],
        [44.967786, 6.056442],
        [44.967725, 6.05649],
        [44.967665, 6.056497],
        [44.967587, 6.056473],
        [44.967403, 6.056416],
        [44.967485, 6.056367],
        [44.967359, 6.056352],
        [44.967257, 6.05632],
        [44.96738, 6.056188],
        [44.967246, 6.056161],
        [44.967209, 6.056094],
        [44.967173, 6.056064],
        [44.967318, 6.055945],
        [44.967229, 6.055911],
        [44.967106, 6.055828],
        [44.96698, 6.055807],
        [44.966895, 6.055721],
        [44.966853, 6.055686],
        [44.966782, 6.055659],
        [44.966772, 6.055604],
        [44.966697, 6.055574],
        [44.966667, 6.055587],
        [44.966641, 6.055629],
        [44.966612, 6.055702],
        [44.966571, 6.055781],
        [44.966502, 6.055776],
        [44.966504, 6.055715],
        [44.96649, 6.055708],
        [44.966482, 6.055585],
        [44.96646, 6.055501],
        [44.966427, 6.055499],
        [44.96638, 6.05542],
        [44.966376, 6.055338],
        [44.966286, 6.055202],
        [44.966217, 6.05522],
        [44.966194, 6.055194],
        [44.966192, 6.055104],
        [44.966145, 6.055088],
        [44.96614, 6.055038],
        [44.966113, 6.055004],
        [44.966104, 6.054893],
        [44.966087, 6.054881],
        [44.966061, 6.054802],
        [44.966039, 6.054761],
        [44.965991, 6.054763],
        [44.965933, 6.054815],
        [44.965865, 6.054798],
        [44.965867, 6.054732],
        [44.965851, 6.054679],
        [44.965855, 6.05462],
        [44.965786, 6.054526],
        [44.96573, 6.054536],
        [44.965694, 6.054529],
        [44.965679, 6.054573],
        [44.965674, 6.054622],
        [44.965642, 6.054595],
        [44.965599, 6.05461],
        [44.965552, 6.054611],
        [44.965484, 6.054568],
        [44.965434, 6.054522],
        [44.965373, 6.0545],
        [44.965377, 6.054419],
        [44.965282, 6.054402],
        [44.965249, 6.054329],
        [44.965198, 6.054217],
        [44.96514, 6.054169],
        [44.965105, 6.054101],
        [44.965038, 6.054067],
        [44.964969, 6.054012],
        [44.964864, 6.053928],
        [44.964778, 6.053868],
        [44.964674, 6.053823],
        [44.964583, 6.053773],
        [44.964501, 6.053753],
        [44.964436, 6.05373],
        [44.96436, 6.053733],
        [44.9643, 6.053789],
        [44.964231, 6.05378],
        [44.964156, 6.053761],
        [44.964048, 6.053711],
        [44.963981, 6.053664],
        [44.963947, 6.053666],
        [44.963822, 6.053677],
        [44.963688, 6.053626],
        [44.963632, 6.053495],
        [44.963598, 6.053337],
        [44.963578, 6.053237],
        [44.963525, 6.053121],
        [44.963482, 6.053027],
        [44.963366, 6.052923],
        [44.963278, 6.052799],
        [44.963232, 6.052718],
        [44.963145, 6.05264],
        [44.963072, 6.052599],
        [44.963014, 6.052508],
        [44.962998, 6.052435],
        [44.962919, 6.05231],
        [44.962841, 6.052218],
        [44.962769, 6.05215],
        [44.962622, 6.052125],
        [44.962528, 6.052038],
        [44.962468, 6.051963],
        [44.962417, 6.051846],
        [44.962365, 6.051696],
        [44.962328, 6.051543],
        [44.962271, 6.0513],
        [44.96223, 6.051194],
        [44.962201, 6.051187],
        [44.962184, 6.051134],
        [44.962147, 6.05104],
        [44.962101, 6.050955],
        [44.96208, 6.050813],
        [44.962046, 6.050734],
        [44.962011, 6.050608],
        [44.961975, 6.050464],
        [44.961996, 6.050314],
        [44.962014, 6.050244],
        [44.962036, 6.050207],
        [44.962016, 6.050075],
        [44.961998, 6.04993],
        [44.961999, 6.049794],
        [44.961996, 6.049714],
        [44.961949, 6.049642],
        [44.961891, 6.049536],
        [44.961822, 6.049361],
        [44.96181, 6.04926],
        [44.961818, 6.049079],
        [44.961823, 6.048961],
        [44.961853, 6.048855],
        [44.961823, 6.048717],
        [44.961865, 6.048544],
        [44.961908, 6.048402],
        [44.96191, 6.048385],
        [44.961837, 6.04836],
        [44.961837, 6.04836],
        [44.96191, 6.048385],
        [44.96193, 6.048271],
        [44.961953, 6.048128],
        [44.962017, 6.0481],
        [44.962066, 6.048065],
        [44.962068, 6.04797],
        [44.962031, 6.0479],
        [44.962024, 6.04785],
        [44.961932, 6.047807],
        [44.961922, 6.047781],
        [44.961968, 6.047743],
        [44.962041, 6.047709],
        [44.96208, 6.047682],
        [44.962058, 6.047611],
        [44.962019, 6.047586],
        [44.961991, 6.047523],
        [44.961945, 6.047497],
        [44.961932, 6.047446],
        [44.961995, 6.047419],
        [44.962064, 6.047426],
        [44.962062, 6.047348],
        [44.962008, 6.047265],
        [44.961959, 6.047233],
        [44.961914, 6.047213],
        [44.961883, 6.047169],
        [44.961876, 6.047117],
        [44.961907, 6.047081],
        [44.961899, 6.046989],
        [44.961831, 6.046923],
        [44.961845, 6.046874],
        [44.961787, 6.046784],
        [44.961707, 6.046664],
        [44.961655, 6.046631],
        [44.961592, 6.046566],
        [44.961552, 6.046502],
        [44.961465, 6.046484],
        [44.9614, 6.046478],
        [44.961275, 6.046483],
        [44.96119, 6.046482],
        [44.961137, 6.046515],
        [44.961043, 6.046473],
        [44.960989, 6.046451],
        [44.961054, 6.046327],
        [44.961139, 6.046154],
        [44.961013, 6.046146],
        [44.960958, 6.046141],
        [44.96089, 6.046056],
        [44.96086, 6.045892],
        [44.960882, 6.045698],
        [44.960871, 6.045609],
        [44.960845, 6.045496],
        [44.960755, 6.045382],
        [44.960614, 6.045309],
        [44.96045, 6.045222],
        [44.960357, 6.045165],
        [44.960267, 6.045144],
        [44.960188, 6.045151],
        [44.960139, 6.045141],
        [44.960105, 6.045135],
        [44.96003, 6.045203],
        [44.959926, 6.045311],
        [44.959852, 6.045372],
        [44.959794, 6.045396],
        [44.959697, 6.045445],
        [44.959564, 6.045462],
        [44.959495, 6.045467],
        [44.959443, 6.04544],
        [44.959375, 6.045407],
        [44.959331, 6.045386],
        [44.959277, 6.045393],
        [44.959277, 6.045393],
        [44.959277, 6.045374],
        [44.959211, 6.045377],
      ];

      const polyline = L.polyline(latlngs);
      polyline.computeStats();

      expect(polyline.getDistance()).to.be.greaterThan(0);
      expect(polyline.getAltMin()).to.be.undefined;
      expect(polyline.getAltMax()).to.be.undefined;
      expect(polyline.getSlopeMin()).to.be.undefined;
      expect(polyline.getSlopeMax()).to.be.undefined;
      expect(polyline.getHeightDiffUp()).to.be.undefined;
      expect(polyline.getHeightDiffDown()).to.be.undefined;
      expect(polyline.getSlopeTerrainMin()).to.be.undefined;
      expect(polyline.getSlopeTerrainMax()).to.be.undefined;
    });

    it('computing stats when only altitude data is available should fail gracefully', async () => {
      const latlngs = [
        [44.988659, 6.078873],
        [44.988783, 6.078814],
        [44.988776, 6.078788],
        [44.988662, 6.078523],
        [44.988601, 6.078367],
        [44.98856, 6.078209],
        [44.988528, 6.078066],
        [44.988495, 6.077877],
        [44.988452, 6.07774],
        [44.988452, 6.077597],
        [44.988399, 6.0774],
        [44.988384, 6.077257],
        [44.988384, 6.077257],
        [44.988387, 6.077104],
        [44.988296, 6.076986],
        [44.988296, 6.076986],
        [44.988138, 6.076772],
        [44.988051, 6.076738],
        [44.987886, 6.076694],
        [44.987797, 6.076617],
        [44.987455, 6.076065],
        [44.98714, 6.075665],
        [44.987076, 6.075617],
        [44.986941, 6.07559],
        [44.986822, 6.075589],
        [44.986709, 6.075583],
        [44.986644, 6.07554],
        [44.986605, 6.075479],
        [44.986604, 6.075404],
        [44.986617, 6.075305],
        [44.986646, 6.07516],
        [44.986608, 6.075112],
        [44.986531, 6.075139],
        [44.986459, 6.075183],
        [44.986395, 6.075186],
        [44.986326, 6.075151],
        [44.986223, 6.075099],
        [44.986137, 6.075136],
        [44.986053, 6.07512],
        [44.985962, 6.075062],
        [44.985963, 6.074984],
        [44.985996, 6.074816],
        [44.98605, 6.074631],
        [44.986079, 6.07444],
        [44.986159, 6.074302],
        [44.98618, 6.07422],
        [44.986173, 6.07417],
        [44.986074, 6.074137],
        [44.985933, 6.074105],
        [44.985776, 6.074119],
        [44.985611, 6.074127],
        [44.985504, 6.074084],
        [44.985341, 6.073989],
        [44.985208, 6.073925],
        [44.985137, 6.073942],
        [44.984934, 6.073841],
        [44.984875, 6.073739],
        [44.984834, 6.07364],
        [44.984784, 6.073599],
        [44.984741, 6.073569],
        [44.984661, 6.073512],
        [44.984592, 6.073445],
        [44.984452, 6.073332],
        [44.98439, 6.073235],
        [44.984293, 6.073115],
        [44.984175, 6.072909],
        [44.984121, 6.072805],
        [44.984057, 6.072655],
        [44.984022, 6.072627],
        [44.983982, 6.072643],
        [44.983982, 6.072643],
        [44.983725, 6.072784],
        [44.983431, 6.072764],
        [44.983277, 6.072734],
        [44.982906, 6.072492],
        [44.982647, 6.072236],
        [44.982378, 6.072277],
        [44.982096, 6.072278],
        [44.981775, 6.072218],
        [44.98145, 6.071838],
        [44.981358, 6.071794],
        [44.981374, 6.071727],
        [44.981374, 6.071727],
        [44.981358, 6.071794],
        [44.981214, 6.071723],
        [44.980984, 6.071471],
        [44.980921, 6.071268],
        [44.980837, 6.071243],
        [44.980683, 6.071212],
        [44.980645, 6.071071],
        [44.980682, 6.070816],
        [44.980638, 6.070686],
        [44.980605, 6.070593],
        [44.980638, 6.070551],
        [44.980693, 6.07048],
        [44.980672, 6.070281],
        [44.98064, 6.070261],
        [44.980548, 6.070212],
        [44.980467, 6.070262],
        [44.980467, 6.070262],
        [44.98045, 6.070338],
        [44.980411, 6.070402],
        [44.980331, 6.070399],
        [44.980291, 6.070342],
        [44.980245, 6.070309],
        [44.980174, 6.070209],
        [44.980104, 6.070201],
        [44.979989, 6.07027],
        [44.98, 6.070178],
        [44.98005, 6.070046],
        [44.980108, 6.069985],
        [44.980183, 6.069863],
        [44.98005, 6.069831],
        [44.979979, 6.069787],
        [44.979822, 6.069786],
        [44.979784, 6.069851],
        [44.979709, 6.070115],
        [44.979581, 6.070435],
        [44.979509, 6.070456],
        [44.979419, 6.070392],
        [44.979462, 6.070274],
        [44.979379, 6.070251],
        [44.979227, 6.070143],
        [44.979159, 6.070109],
        [44.979147, 6.070069],
        [44.979177, 6.069979],
        [44.979276, 6.06987],
        [44.979264, 6.069589],
        [44.979276, 6.069288],
        [44.979315, 6.06905],
        [44.979319, 6.068836],
        [44.979298, 6.068682],
        [44.979357, 6.068402],
        [44.979468, 6.068332],
        [44.97947, 6.068271],
        [44.979417, 6.068192],
        [44.979325, 6.068002],
        [44.979214, 6.06778],
        [44.979109, 6.067836],
        [44.979054, 6.067761],
        [44.979003, 6.067763],
        [44.978906, 6.067936],
        [44.978835, 6.068022],
        [44.978702, 6.068178],
        [44.978726, 6.068023],
        [44.978692, 6.068028],
        [44.978631, 6.068138],
        [44.978541, 6.068199],
        [44.978369, 6.068284],
        [44.978254, 6.068334],
        [44.978238, 6.068307],
        [44.978296, 6.068113],
        [44.978362, 6.068045],
        [44.978349, 6.067966],
        [44.978389, 6.06786],
        [44.978367, 6.06776],
        [44.978375, 6.067607],
        [44.978424, 6.067578],
        [44.978433, 6.067472],
        [44.978442, 6.067362],
        [44.978337, 6.06738],
        [44.978219, 6.067456],
        [44.978279, 6.067312],
        [44.978298, 6.067195],
        [44.978203, 6.067279],
        [44.978069, 6.067378],
        [44.978103, 6.067197],
        [44.977984, 6.067244],
        [44.977853, 6.067285],
        [44.977885, 6.067183],
        [44.977807, 6.067237],
        [44.977804, 6.067187],
        [44.977858, 6.067082],
        [44.977813, 6.06704],
        [44.977818, 6.066994],
        [44.977894, 6.066842],
        [44.977815, 6.06689],
        [44.977713, 6.066982],
        [44.977618, 6.067008],
        [44.977671, 6.066894],
        [44.977749, 6.066731],
        [44.977686, 6.066733],
        [44.977689, 6.066617],
        [44.977547, 6.066594],
        [44.97765, 6.066341],
        [44.977717, 6.066186],
        [44.977648, 6.066183],
        [44.977531, 6.066086],
        [44.977477, 6.06599],
        [44.977379, 6.065902],
        [44.977221, 6.06581],
        [44.977138, 6.065813],
        [44.977097, 6.065723],
        [44.977107, 6.065641],
        [44.977029, 6.065404],
        [44.976968, 6.065249],
        [44.976842, 6.0651],
        [44.9768, 6.064991],
        [44.976725, 6.064889],
        [44.976621, 6.064892],
        [44.976575, 6.064803],
        [44.976457, 6.064724],
        [44.976296, 6.064604],
        [44.976294, 6.064555],
        [44.976333, 6.064507],
        [44.976365, 6.064445],
        [44.976303, 6.064387],
        [44.976208, 6.064319],
        [44.97612, 6.064193],
        [44.975944, 6.063992],
        [44.975771, 6.063872],
        [44.975657, 6.063788],
        [44.97555, 6.063767],
        [44.975451, 6.063792],
        [44.975334, 6.06385],
        [44.975254, 6.063883],
        [44.975193, 6.063838],
        [44.975069, 6.063854],
        [44.975053, 6.063949],
        [44.975087, 6.064024],
        [44.975055, 6.064145],
        [44.97501, 6.064177],
        [44.974937, 6.064222],
        [44.974864, 6.064369],
        [44.974813, 6.06437],
        [44.974757, 6.064421],
        [44.974692, 6.064539],
        [44.974597, 6.064628],
        [44.974552, 6.064708],
        [44.974529, 6.06472],
        [44.974409, 6.064664],
        [44.97435, 6.064853],
        [44.974306, 6.064943],
        [44.974242, 6.065017],
        [44.974186, 6.065151],
        [44.974146, 6.065141],
        [44.974126, 6.065209],
        [44.974131, 6.065307],
        [44.974113, 6.065486],
        [44.974099, 6.065606],
        [44.97407, 6.065664],
        [44.974031, 6.065718],
        [44.974031, 6.065718],
        [44.974029, 6.065621],
        [44.974025, 6.065415],
        [44.974004, 6.065298],
        [44.973972, 6.065209],
        [44.973881, 6.065076],
        [44.97384, 6.064986],
        [44.973834, 6.064855],
        [44.973838, 6.064699],
        [44.973827, 6.064528],
        [44.973864, 6.064409],
        [44.973884, 6.064262],
        [44.973938, 6.064217],
        [44.973969, 6.064083],
        [44.973992, 6.063936],
        [44.973989, 6.063856],
        [44.973907, 6.063761],
        [44.973834, 6.063747],
        [44.973771, 6.063837],
        [44.973699, 6.063823],
        [44.973635, 6.063774],
        [44.973582, 6.063668],
        [44.973515, 6.063533],
        [44.973453, 6.063388],
        [44.973372, 6.063233],
        [44.973326, 6.06306],
        [44.97328, 6.062876],
        [44.973229, 6.062672],
        [44.97323, 6.062637],
        [44.973087, 6.062629],
        [44.973087, 6.062629],
        [44.97323, 6.062637],
        [44.973233, 6.062508],
        [44.973177, 6.06243],
        [44.97308, 6.062236],
        [44.972912, 6.061966],
        [44.972793, 6.061768],
        [44.972697, 6.061564],
        [44.972605, 6.061363],
        [44.972515, 6.061171],
        [44.972445, 6.061008],
        [44.972372, 6.060892],
        [44.972277, 6.060741],
        [44.972173, 6.060688],
        [44.972136, 6.060637],
        [44.972046, 6.060604],
        [44.972004, 6.060548],
        [44.971938, 6.060539],
        [44.971803, 6.060486],
        [44.971705, 6.060396],
        [44.971616, 6.060404],
        [44.971568, 6.060367],
        [44.971489, 6.060384],
        [44.971468, 6.060249],
        [44.971427, 6.060088],
        [44.97136, 6.059991],
        [44.971324, 6.059906],
        [44.971243, 6.059834],
        [44.971175, 6.059816],
        [44.971104, 6.05989],
        [44.971056, 6.060039],
        [44.97102, 6.060092],
        [44.970971, 6.060036],
        [44.970989, 6.059941],
        [44.970943, 6.059911],
        [44.970954, 6.059757],
        [44.970896, 6.059745],
        [44.970831, 6.059659],
        [44.970788, 6.059709],
        [44.970739, 6.059725],
        [44.970683, 6.05973],
        [44.970584, 6.05969],
        [44.970472, 6.059596],
        [44.970464, 6.059507],
        [44.97053, 6.059451],
        [44.97054, 6.0594],
        [44.97059, 6.059341],
        [44.9706, 6.059257],
        [44.970625, 6.059188],
        [44.970612, 6.059058],
        [44.970588, 6.058958],
        [44.970586, 6.058859],
        [44.97053, 6.058748],
        [44.970423, 6.05864],
        [44.970333, 6.058554],
        [44.97019, 6.058507],
        [44.970078, 6.0585],
        [44.969988, 6.058488],
        [44.969918, 6.058526],
        [44.969839, 6.058497],
        [44.969762, 6.058442],
        [44.96967, 6.058391],
        [44.969571, 6.058359],
        [44.969513, 6.058365],
        [44.969414, 6.058345],
        [44.969285, 6.058363],
        [44.969198, 6.058373],
        [44.969179, 6.058326],
        [44.969198, 6.058282],
        [44.969249, 6.05822],
        [44.969263, 6.058105],
        [44.969156, 6.058095],
        [44.969064, 6.058094],
        [44.96896, 6.058074],
        [44.968909, 6.058049],
        [44.96905, 6.058012],
        [44.969083, 6.057976],
        [44.969171, 6.057931],
        [44.969275, 6.057887],
        [44.969365, 6.057878],
        [44.969453, 6.05779],
        [44.969573, 6.057761],
        [44.969573, 6.057761],
        [44.96954, 6.057719],
        [44.969419, 6.057673],
        [44.969369, 6.057627],
        [44.969284, 6.057595],
        [44.969244, 6.057489],
        [44.969166, 6.057436],
        [44.969109, 6.05742],
        [44.969088, 6.057377],
        [44.969126, 6.057353],
        [44.969104, 6.05729],
        [44.969033, 6.057279],
        [44.9689, 6.057223],
        [44.968798, 6.057122],
        [44.968753, 6.057065],
        [44.968706, 6.057013],
        [44.968622, 6.057076],
        [44.968593, 6.057025],
        [44.968532, 6.057027],
        [44.968482, 6.056943],
        [44.968419, 6.056929],
        [44.968296, 6.056803],
        [44.968222, 6.056696],
        [44.968131, 6.056623],
        [44.968073, 6.056635],
        [44.967995, 6.05659],
        [44.967888, 6.056494],
        [44.967822, 6.056419],
        [44.967786, 6.056442],
        [44.967725, 6.05649],
        [44.967665, 6.056497],
        [44.967587, 6.056473],
        [44.967403, 6.056416],
        [44.967485, 6.056367],
        [44.967359, 6.056352],
        [44.967257, 6.05632],
        [44.96738, 6.056188],
        [44.967246, 6.056161],
        [44.967209, 6.056094],
        [44.967173, 6.056064],
        [44.967318, 6.055945],
        [44.967229, 6.055911],
        [44.967106, 6.055828],
        [44.96698, 6.055807],
        [44.966895, 6.055721],
        [44.966853, 6.055686],
        [44.966782, 6.055659],
        [44.966772, 6.055604],
        [44.966697, 6.055574],
        [44.966667, 6.055587],
        [44.966641, 6.055629],
        [44.966612, 6.055702],
        [44.966571, 6.055781],
        [44.966502, 6.055776],
        [44.966504, 6.055715],
        [44.96649, 6.055708],
        [44.966482, 6.055585],
        [44.96646, 6.055501],
        [44.966427, 6.055499],
        [44.96638, 6.05542],
        [44.966376, 6.055338],
        [44.966286, 6.055202],
        [44.966217, 6.05522],
        [44.966194, 6.055194],
        [44.966192, 6.055104],
        [44.966145, 6.055088],
        [44.96614, 6.055038],
        [44.966113, 6.055004],
        [44.966104, 6.054893],
        [44.966087, 6.054881],
        [44.966061, 6.054802],
        [44.966039, 6.054761],
        [44.965991, 6.054763],
        [44.965933, 6.054815],
        [44.965865, 6.054798],
        [44.965867, 6.054732],
        [44.965851, 6.054679],
        [44.965855, 6.05462],
        [44.965786, 6.054526],
        [44.96573, 6.054536],
        [44.965694, 6.054529],
        [44.965679, 6.054573],
        [44.965674, 6.054622],
        [44.965642, 6.054595],
        [44.965599, 6.05461],
        [44.965552, 6.054611],
        [44.965484, 6.054568],
        [44.965434, 6.054522],
        [44.965373, 6.0545],
        [44.965377, 6.054419],
        [44.965282, 6.054402],
        [44.965249, 6.054329],
        [44.965198, 6.054217],
        [44.96514, 6.054169],
        [44.965105, 6.054101],
        [44.965038, 6.054067],
        [44.964969, 6.054012],
        [44.964864, 6.053928],
        [44.964778, 6.053868],
        [44.964674, 6.053823],
        [44.964583, 6.053773],
        [44.964501, 6.053753],
        [44.964436, 6.05373],
        [44.96436, 6.053733],
        [44.9643, 6.053789],
        [44.964231, 6.05378],
        [44.964156, 6.053761],
        [44.964048, 6.053711],
        [44.963981, 6.053664],
        [44.963947, 6.053666],
        [44.963822, 6.053677],
        [44.963688, 6.053626],
        [44.963632, 6.053495],
        [44.963598, 6.053337],
        [44.963578, 6.053237],
        [44.963525, 6.053121],
        [44.963482, 6.053027],
        [44.963366, 6.052923],
        [44.963278, 6.052799],
        [44.963232, 6.052718],
        [44.963145, 6.05264],
        [44.963072, 6.052599],
        [44.963014, 6.052508],
        [44.962998, 6.052435],
        [44.962919, 6.05231],
        [44.962841, 6.052218],
        [44.962769, 6.05215],
        [44.962622, 6.052125],
        [44.962528, 6.052038],
        [44.962468, 6.051963],
        [44.962417, 6.051846],
        [44.962365, 6.051696],
        [44.962328, 6.051543],
        [44.962271, 6.0513],
        [44.96223, 6.051194],
        [44.962201, 6.051187],
        [44.962184, 6.051134],
        [44.962147, 6.05104],
        [44.962101, 6.050955],
        [44.96208, 6.050813],
        [44.962046, 6.050734],
        [44.962011, 6.050608],
        [44.961975, 6.050464],
        [44.961996, 6.050314],
        [44.962014, 6.050244],
        [44.962036, 6.050207],
        [44.962016, 6.050075],
        [44.961998, 6.04993],
        [44.961999, 6.049794],
        [44.961996, 6.049714],
        [44.961949, 6.049642],
        [44.961891, 6.049536],
        [44.961822, 6.049361],
        [44.96181, 6.04926],
        [44.961818, 6.049079],
        [44.961823, 6.048961],
        [44.961853, 6.048855],
        [44.961823, 6.048717],
        [44.961865, 6.048544],
        [44.961908, 6.048402],
        [44.96191, 6.048385],
        [44.961837, 6.04836],
        [44.961837, 6.04836],
        [44.96191, 6.048385],
        [44.96193, 6.048271],
        [44.961953, 6.048128],
        [44.962017, 6.0481],
        [44.962066, 6.048065],
        [44.962068, 6.04797],
        [44.962031, 6.0479],
        [44.962024, 6.04785],
        [44.961932, 6.047807],
        [44.961922, 6.047781],
        [44.961968, 6.047743],
        [44.962041, 6.047709],
        [44.96208, 6.047682],
        [44.962058, 6.047611],
        [44.962019, 6.047586],
        [44.961991, 6.047523],
        [44.961945, 6.047497],
        [44.961932, 6.047446],
        [44.961995, 6.047419],
        [44.962064, 6.047426],
        [44.962062, 6.047348],
        [44.962008, 6.047265],
        [44.961959, 6.047233],
        [44.961914, 6.047213],
        [44.961883, 6.047169],
        [44.961876, 6.047117],
        [44.961907, 6.047081],
        [44.961899, 6.046989],
        [44.961831, 6.046923],
        [44.961845, 6.046874],
        [44.961787, 6.046784],
        [44.961707, 6.046664],
        [44.961655, 6.046631],
        [44.961592, 6.046566],
        [44.961552, 6.046502],
        [44.961465, 6.046484],
        [44.9614, 6.046478],
        [44.961275, 6.046483],
        [44.96119, 6.046482],
        [44.961137, 6.046515],
        [44.961043, 6.046473],
        [44.960989, 6.046451],
        [44.961054, 6.046327],
        [44.961139, 6.046154],
        [44.961013, 6.046146],
        [44.960958, 6.046141],
        [44.96089, 6.046056],
        [44.96086, 6.045892],
        [44.960882, 6.045698],
        [44.960871, 6.045609],
        [44.960845, 6.045496],
        [44.960755, 6.045382],
        [44.960614, 6.045309],
        [44.96045, 6.045222],
        [44.960357, 6.045165],
        [44.960267, 6.045144],
        [44.960188, 6.045151],
        [44.960139, 6.045141],
        [44.960105, 6.045135],
        [44.96003, 6.045203],
        [44.959926, 6.045311],
        [44.959852, 6.045372],
        [44.959794, 6.045396],
        [44.959697, 6.045445],
        [44.959564, 6.045462],
        [44.959495, 6.045467],
        [44.959443, 6.04544],
        [44.959375, 6.045407],
        [44.959331, 6.045386],
        [44.959277, 6.045393],
        [44.959277, 6.045393],
        [44.959277, 6.045374],
        [44.959211, 6.045377],
      ];

      const fetcher = {
        fetchAltitudes(array) {
          return new Promise(resolve => {
            resolve(array.map((x, i) => ({ lat: x.lat, lng: x.lng, z: i })));
          });
        },
      };
      const polyline = L.polyline(latlngs);
      await polyline.fetchAltitude(fetcher);
      polyline.computeStats();

      expect(polyline.getDistance()).to.be.greaterThan(0);
      expect(polyline.getAltMin()).to.not.be.undefined;
      expect(polyline.getAltMax()).to.not.be.undefined;
      expect(polyline.getSlopeMin()).to.not.be.undefined;
      expect(polyline.getSlopeMax()).to.not.be.undefined;
      expect(polyline.getHeightDiffUp()).to.not.be.undefined;
      expect(polyline.getHeightDiffDown()).to.not.be.undefined;
      expect(polyline.getSlopeTerrainMin()).to.be.undefined;
      expect(polyline.getSlopeTerrainMax()).to.be.undefined;
    });
    
    it('computing stats when only slope data is available should fail gracefully', async () => {
      const latlngs = [
        [44.988659, 6.078873],
        [44.988783, 6.078814],
        [44.988776, 6.078788],
        [44.988662, 6.078523],
        [44.988601, 6.078367],
        [44.98856, 6.078209],
        [44.988528, 6.078066],
        [44.988495, 6.077877],
        [44.988452, 6.07774],
        [44.988452, 6.077597],
        [44.988399, 6.0774],
        [44.988384, 6.077257],
        [44.988384, 6.077257],
        [44.988387, 6.077104],
        [44.988296, 6.076986],
        [44.988296, 6.076986],
        [44.988138, 6.076772],
        [44.988051, 6.076738],
        [44.987886, 6.076694],
        [44.987797, 6.076617],
        [44.987455, 6.076065],
        [44.98714, 6.075665],
        [44.987076, 6.075617],
        [44.986941, 6.07559],
        [44.986822, 6.075589],
        [44.986709, 6.075583],
        [44.986644, 6.07554],
        [44.986605, 6.075479],
        [44.986604, 6.075404],
        [44.986617, 6.075305],
        [44.986646, 6.07516],
        [44.986608, 6.075112],
        [44.986531, 6.075139],
        [44.986459, 6.075183],
        [44.986395, 6.075186],
        [44.986326, 6.075151],
        [44.986223, 6.075099],
        [44.986137, 6.075136],
        [44.986053, 6.07512],
        [44.985962, 6.075062],
        [44.985963, 6.074984],
        [44.985996, 6.074816],
        [44.98605, 6.074631],
        [44.986079, 6.07444],
        [44.986159, 6.074302],
        [44.98618, 6.07422],
        [44.986173, 6.07417],
        [44.986074, 6.074137],
        [44.985933, 6.074105],
        [44.985776, 6.074119],
        [44.985611, 6.074127],
        [44.985504, 6.074084],
        [44.985341, 6.073989],
        [44.985208, 6.073925],
        [44.985137, 6.073942],
        [44.984934, 6.073841],
        [44.984875, 6.073739],
        [44.984834, 6.07364],
        [44.984784, 6.073599],
        [44.984741, 6.073569],
        [44.984661, 6.073512],
        [44.984592, 6.073445],
        [44.984452, 6.073332],
        [44.98439, 6.073235],
        [44.984293, 6.073115],
        [44.984175, 6.072909],
        [44.984121, 6.072805],
        [44.984057, 6.072655],
        [44.984022, 6.072627],
        [44.983982, 6.072643],
        [44.983982, 6.072643],
        [44.983725, 6.072784],
        [44.983431, 6.072764],
        [44.983277, 6.072734],
        [44.982906, 6.072492],
        [44.982647, 6.072236],
        [44.982378, 6.072277],
        [44.982096, 6.072278],
        [44.981775, 6.072218],
        [44.98145, 6.071838],
        [44.981358, 6.071794],
        [44.981374, 6.071727],
        [44.981374, 6.071727],
        [44.981358, 6.071794],
        [44.981214, 6.071723],
        [44.980984, 6.071471],
        [44.980921, 6.071268],
        [44.980837, 6.071243],
        [44.980683, 6.071212],
        [44.980645, 6.071071],
        [44.980682, 6.070816],
        [44.980638, 6.070686],
        [44.980605, 6.070593],
        [44.980638, 6.070551],
        [44.980693, 6.07048],
        [44.980672, 6.070281],
        [44.98064, 6.070261],
        [44.980548, 6.070212],
        [44.980467, 6.070262],
        [44.980467, 6.070262],
        [44.98045, 6.070338],
        [44.980411, 6.070402],
        [44.980331, 6.070399],
        [44.980291, 6.070342],
        [44.980245, 6.070309],
        [44.980174, 6.070209],
        [44.980104, 6.070201],
        [44.979989, 6.07027],
        [44.98, 6.070178],
        [44.98005, 6.070046],
        [44.980108, 6.069985],
        [44.980183, 6.069863],
        [44.98005, 6.069831],
        [44.979979, 6.069787],
        [44.979822, 6.069786],
        [44.979784, 6.069851],
        [44.979709, 6.070115],
        [44.979581, 6.070435],
        [44.979509, 6.070456],
        [44.979419, 6.070392],
        [44.979462, 6.070274],
        [44.979379, 6.070251],
        [44.979227, 6.070143],
        [44.979159, 6.070109],
        [44.979147, 6.070069],
        [44.979177, 6.069979],
        [44.979276, 6.06987],
        [44.979264, 6.069589],
        [44.979276, 6.069288],
        [44.979315, 6.06905],
        [44.979319, 6.068836],
        [44.979298, 6.068682],
        [44.979357, 6.068402],
        [44.979468, 6.068332],
        [44.97947, 6.068271],
        [44.979417, 6.068192],
        [44.979325, 6.068002],
        [44.979214, 6.06778],
        [44.979109, 6.067836],
        [44.979054, 6.067761],
        [44.979003, 6.067763],
        [44.978906, 6.067936],
        [44.978835, 6.068022],
        [44.978702, 6.068178],
        [44.978726, 6.068023],
        [44.978692, 6.068028],
        [44.978631, 6.068138],
        [44.978541, 6.068199],
        [44.978369, 6.068284],
        [44.978254, 6.068334],
        [44.978238, 6.068307],
        [44.978296, 6.068113],
        [44.978362, 6.068045],
        [44.978349, 6.067966],
        [44.978389, 6.06786],
        [44.978367, 6.06776],
        [44.978375, 6.067607],
        [44.978424, 6.067578],
        [44.978433, 6.067472],
        [44.978442, 6.067362],
        [44.978337, 6.06738],
        [44.978219, 6.067456],
        [44.978279, 6.067312],
        [44.978298, 6.067195],
        [44.978203, 6.067279],
        [44.978069, 6.067378],
        [44.978103, 6.067197],
        [44.977984, 6.067244],
        [44.977853, 6.067285],
        [44.977885, 6.067183],
        [44.977807, 6.067237],
        [44.977804, 6.067187],
        [44.977858, 6.067082],
        [44.977813, 6.06704],
        [44.977818, 6.066994],
        [44.977894, 6.066842],
        [44.977815, 6.06689],
        [44.977713, 6.066982],
        [44.977618, 6.067008],
        [44.977671, 6.066894],
        [44.977749, 6.066731],
        [44.977686, 6.066733],
        [44.977689, 6.066617],
        [44.977547, 6.066594],
        [44.97765, 6.066341],
        [44.977717, 6.066186],
        [44.977648, 6.066183],
        [44.977531, 6.066086],
        [44.977477, 6.06599],
        [44.977379, 6.065902],
        [44.977221, 6.06581],
        [44.977138, 6.065813],
        [44.977097, 6.065723],
        [44.977107, 6.065641],
        [44.977029, 6.065404],
        [44.976968, 6.065249],
        [44.976842, 6.0651],
        [44.9768, 6.064991],
        [44.976725, 6.064889],
        [44.976621, 6.064892],
        [44.976575, 6.064803],
        [44.976457, 6.064724],
        [44.976296, 6.064604],
        [44.976294, 6.064555],
        [44.976333, 6.064507],
        [44.976365, 6.064445],
        [44.976303, 6.064387],
        [44.976208, 6.064319],
        [44.97612, 6.064193],
        [44.975944, 6.063992],
        [44.975771, 6.063872],
        [44.975657, 6.063788],
        [44.97555, 6.063767],
        [44.975451, 6.063792],
        [44.975334, 6.06385],
        [44.975254, 6.063883],
        [44.975193, 6.063838],
        [44.975069, 6.063854],
        [44.975053, 6.063949],
        [44.975087, 6.064024],
        [44.975055, 6.064145],
        [44.97501, 6.064177],
        [44.974937, 6.064222],
        [44.974864, 6.064369],
        [44.974813, 6.06437],
        [44.974757, 6.064421],
        [44.974692, 6.064539],
        [44.974597, 6.064628],
        [44.974552, 6.064708],
        [44.974529, 6.06472],
        [44.974409, 6.064664],
        [44.97435, 6.064853],
        [44.974306, 6.064943],
        [44.974242, 6.065017],
        [44.974186, 6.065151],
        [44.974146, 6.065141],
        [44.974126, 6.065209],
        [44.974131, 6.065307],
        [44.974113, 6.065486],
        [44.974099, 6.065606],
        [44.97407, 6.065664],
        [44.974031, 6.065718],
        [44.974031, 6.065718],
        [44.974029, 6.065621],
        [44.974025, 6.065415],
        [44.974004, 6.065298],
        [44.973972, 6.065209],
        [44.973881, 6.065076],
        [44.97384, 6.064986],
        [44.973834, 6.064855],
        [44.973838, 6.064699],
        [44.973827, 6.064528],
        [44.973864, 6.064409],
        [44.973884, 6.064262],
        [44.973938, 6.064217],
        [44.973969, 6.064083],
        [44.973992, 6.063936],
        [44.973989, 6.063856],
        [44.973907, 6.063761],
        [44.973834, 6.063747],
        [44.973771, 6.063837],
        [44.973699, 6.063823],
        [44.973635, 6.063774],
        [44.973582, 6.063668],
        [44.973515, 6.063533],
        [44.973453, 6.063388],
        [44.973372, 6.063233],
        [44.973326, 6.06306],
        [44.97328, 6.062876],
        [44.973229, 6.062672],
        [44.97323, 6.062637],
        [44.973087, 6.062629],
        [44.973087, 6.062629],
        [44.97323, 6.062637],
        [44.973233, 6.062508],
        [44.973177, 6.06243],
        [44.97308, 6.062236],
        [44.972912, 6.061966],
        [44.972793, 6.061768],
        [44.972697, 6.061564],
        [44.972605, 6.061363],
        [44.972515, 6.061171],
        [44.972445, 6.061008],
        [44.972372, 6.060892],
        [44.972277, 6.060741],
        [44.972173, 6.060688],
        [44.972136, 6.060637],
        [44.972046, 6.060604],
        [44.972004, 6.060548],
        [44.971938, 6.060539],
        [44.971803, 6.060486],
        [44.971705, 6.060396],
        [44.971616, 6.060404],
        [44.971568, 6.060367],
        [44.971489, 6.060384],
        [44.971468, 6.060249],
        [44.971427, 6.060088],
        [44.97136, 6.059991],
        [44.971324, 6.059906],
        [44.971243, 6.059834],
        [44.971175, 6.059816],
        [44.971104, 6.05989],
        [44.971056, 6.060039],
        [44.97102, 6.060092],
        [44.970971, 6.060036],
        [44.970989, 6.059941],
        [44.970943, 6.059911],
        [44.970954, 6.059757],
        [44.970896, 6.059745],
        [44.970831, 6.059659],
        [44.970788, 6.059709],
        [44.970739, 6.059725],
        [44.970683, 6.05973],
        [44.970584, 6.05969],
        [44.970472, 6.059596],
        [44.970464, 6.059507],
        [44.97053, 6.059451],
        [44.97054, 6.0594],
        [44.97059, 6.059341],
        [44.9706, 6.059257],
        [44.970625, 6.059188],
        [44.970612, 6.059058],
        [44.970588, 6.058958],
        [44.970586, 6.058859],
        [44.97053, 6.058748],
        [44.970423, 6.05864],
        [44.970333, 6.058554],
        [44.97019, 6.058507],
        [44.970078, 6.0585],
        [44.969988, 6.058488],
        [44.969918, 6.058526],
        [44.969839, 6.058497],
        [44.969762, 6.058442],
        [44.96967, 6.058391],
        [44.969571, 6.058359],
        [44.969513, 6.058365],
        [44.969414, 6.058345],
        [44.969285, 6.058363],
        [44.969198, 6.058373],
        [44.969179, 6.058326],
        [44.969198, 6.058282],
        [44.969249, 6.05822],
        [44.969263, 6.058105],
        [44.969156, 6.058095],
        [44.969064, 6.058094],
        [44.96896, 6.058074],
        [44.968909, 6.058049],
        [44.96905, 6.058012],
        [44.969083, 6.057976],
        [44.969171, 6.057931],
        [44.969275, 6.057887],
        [44.969365, 6.057878],
        [44.969453, 6.05779],
        [44.969573, 6.057761],
        [44.969573, 6.057761],
        [44.96954, 6.057719],
        [44.969419, 6.057673],
        [44.969369, 6.057627],
        [44.969284, 6.057595],
        [44.969244, 6.057489],
        [44.969166, 6.057436],
        [44.969109, 6.05742],
        [44.969088, 6.057377],
        [44.969126, 6.057353],
        [44.969104, 6.05729],
        [44.969033, 6.057279],
        [44.9689, 6.057223],
        [44.968798, 6.057122],
        [44.968753, 6.057065],
        [44.968706, 6.057013],
        [44.968622, 6.057076],
        [44.968593, 6.057025],
        [44.968532, 6.057027],
        [44.968482, 6.056943],
        [44.968419, 6.056929],
        [44.968296, 6.056803],
        [44.968222, 6.056696],
        [44.968131, 6.056623],
        [44.968073, 6.056635],
        [44.967995, 6.05659],
        [44.967888, 6.056494],
        [44.967822, 6.056419],
        [44.967786, 6.056442],
        [44.967725, 6.05649],
        [44.967665, 6.056497],
        [44.967587, 6.056473],
        [44.967403, 6.056416],
        [44.967485, 6.056367],
        [44.967359, 6.056352],
        [44.967257, 6.05632],
        [44.96738, 6.056188],
        [44.967246, 6.056161],
        [44.967209, 6.056094],
        [44.967173, 6.056064],
        [44.967318, 6.055945],
        [44.967229, 6.055911],
        [44.967106, 6.055828],
        [44.96698, 6.055807],
        [44.966895, 6.055721],
        [44.966853, 6.055686],
        [44.966782, 6.055659],
        [44.966772, 6.055604],
        [44.966697, 6.055574],
        [44.966667, 6.055587],
        [44.966641, 6.055629],
        [44.966612, 6.055702],
        [44.966571, 6.055781],
        [44.966502, 6.055776],
        [44.966504, 6.055715],
        [44.96649, 6.055708],
        [44.966482, 6.055585],
        [44.96646, 6.055501],
        [44.966427, 6.055499],
        [44.96638, 6.05542],
        [44.966376, 6.055338],
        [44.966286, 6.055202],
        [44.966217, 6.05522],
        [44.966194, 6.055194],
        [44.966192, 6.055104],
        [44.966145, 6.055088],
        [44.96614, 6.055038],
        [44.966113, 6.055004],
        [44.966104, 6.054893],
        [44.966087, 6.054881],
        [44.966061, 6.054802],
        [44.966039, 6.054761],
        [44.965991, 6.054763],
        [44.965933, 6.054815],
        [44.965865, 6.054798],
        [44.965867, 6.054732],
        [44.965851, 6.054679],
        [44.965855, 6.05462],
        [44.965786, 6.054526],
        [44.96573, 6.054536],
        [44.965694, 6.054529],
        [44.965679, 6.054573],
        [44.965674, 6.054622],
        [44.965642, 6.054595],
        [44.965599, 6.05461],
        [44.965552, 6.054611],
        [44.965484, 6.054568],
        [44.965434, 6.054522],
        [44.965373, 6.0545],
        [44.965377, 6.054419],
        [44.965282, 6.054402],
        [44.965249, 6.054329],
        [44.965198, 6.054217],
        [44.96514, 6.054169],
        [44.965105, 6.054101],
        [44.965038, 6.054067],
        [44.964969, 6.054012],
        [44.964864, 6.053928],
        [44.964778, 6.053868],
        [44.964674, 6.053823],
        [44.964583, 6.053773],
        [44.964501, 6.053753],
        [44.964436, 6.05373],
        [44.96436, 6.053733],
        [44.9643, 6.053789],
        [44.964231, 6.05378],
        [44.964156, 6.053761],
        [44.964048, 6.053711],
        [44.963981, 6.053664],
        [44.963947, 6.053666],
        [44.963822, 6.053677],
        [44.963688, 6.053626],
        [44.963632, 6.053495],
        [44.963598, 6.053337],
        [44.963578, 6.053237],
        [44.963525, 6.053121],
        [44.963482, 6.053027],
        [44.963366, 6.052923],
        [44.963278, 6.052799],
        [44.963232, 6.052718],
        [44.963145, 6.05264],
        [44.963072, 6.052599],
        [44.963014, 6.052508],
        [44.962998, 6.052435],
        [44.962919, 6.05231],
        [44.962841, 6.052218],
        [44.962769, 6.05215],
        [44.962622, 6.052125],
        [44.962528, 6.052038],
        [44.962468, 6.051963],
        [44.962417, 6.051846],
        [44.962365, 6.051696],
        [44.962328, 6.051543],
        [44.962271, 6.0513],
        [44.96223, 6.051194],
        [44.962201, 6.051187],
        [44.962184, 6.051134],
        [44.962147, 6.05104],
        [44.962101, 6.050955],
        [44.96208, 6.050813],
        [44.962046, 6.050734],
        [44.962011, 6.050608],
        [44.961975, 6.050464],
        [44.961996, 6.050314],
        [44.962014, 6.050244],
        [44.962036, 6.050207],
        [44.962016, 6.050075],
        [44.961998, 6.04993],
        [44.961999, 6.049794],
        [44.961996, 6.049714],
        [44.961949, 6.049642],
        [44.961891, 6.049536],
        [44.961822, 6.049361],
        [44.96181, 6.04926],
        [44.961818, 6.049079],
        [44.961823, 6.048961],
        [44.961853, 6.048855],
        [44.961823, 6.048717],
        [44.961865, 6.048544],
        [44.961908, 6.048402],
        [44.96191, 6.048385],
        [44.961837, 6.04836],
        [44.961837, 6.04836],
        [44.96191, 6.048385],
        [44.96193, 6.048271],
        [44.961953, 6.048128],
        [44.962017, 6.0481],
        [44.962066, 6.048065],
        [44.962068, 6.04797],
        [44.962031, 6.0479],
        [44.962024, 6.04785],
        [44.961932, 6.047807],
        [44.961922, 6.047781],
        [44.961968, 6.047743],
        [44.962041, 6.047709],
        [44.96208, 6.047682],
        [44.962058, 6.047611],
        [44.962019, 6.047586],
        [44.961991, 6.047523],
        [44.961945, 6.047497],
        [44.961932, 6.047446],
        [44.961995, 6.047419],
        [44.962064, 6.047426],
        [44.962062, 6.047348],
        [44.962008, 6.047265],
        [44.961959, 6.047233],
        [44.961914, 6.047213],
        [44.961883, 6.047169],
        [44.961876, 6.047117],
        [44.961907, 6.047081],
        [44.961899, 6.046989],
        [44.961831, 6.046923],
        [44.961845, 6.046874],
        [44.961787, 6.046784],
        [44.961707, 6.046664],
        [44.961655, 6.046631],
        [44.961592, 6.046566],
        [44.961552, 6.046502],
        [44.961465, 6.046484],
        [44.9614, 6.046478],
        [44.961275, 6.046483],
        [44.96119, 6.046482],
        [44.961137, 6.046515],
        [44.961043, 6.046473],
        [44.960989, 6.046451],
        [44.961054, 6.046327],
        [44.961139, 6.046154],
        [44.961013, 6.046146],
        [44.960958, 6.046141],
        [44.96089, 6.046056],
        [44.96086, 6.045892],
        [44.960882, 6.045698],
        [44.960871, 6.045609],
        [44.960845, 6.045496],
        [44.960755, 6.045382],
        [44.960614, 6.045309],
        [44.96045, 6.045222],
        [44.960357, 6.045165],
        [44.960267, 6.045144],
        [44.960188, 6.045151],
        [44.960139, 6.045141],
        [44.960105, 6.045135],
        [44.96003, 6.045203],
        [44.959926, 6.045311],
        [44.959852, 6.045372],
        [44.959794, 6.045396],
        [44.959697, 6.045445],
        [44.959564, 6.045462],
        [44.959495, 6.045467],
        [44.959443, 6.04544],
        [44.959375, 6.045407],
        [44.959331, 6.045386],
        [44.959277, 6.045393],
        [44.959277, 6.045393],
        [44.959277, 6.045374],
        [44.959211, 6.045377],
      ];

      const fetcher = {
        fetchSlopes(array) {
          return new Promise(resolve => {
            resolve(array.map((x, i) => ({ lat: x.lat, lng: x.lng, slope: i })));
          });
        },
      };
      const polyline = L.polyline(latlngs);
      await polyline.fetchSlope(fetcher);
      polyline.computeStats();

      expect(polyline.getDistance()).to.be.greaterThan(0);
      expect(polyline.getAltMin()).to.be.undefined;
      expect(polyline.getAltMax()).to.be.undefined;
      expect(polyline.getSlopeMin()).to.be.undefined;
      expect(polyline.getSlopeMax()).to.be.undefined;
      expect(polyline.getHeightDiffUp()).to.be.undefined;
      expect(polyline.getHeightDiffDown()).to.be.undefined;
      expect(polyline.getSlopeTerrainMin()).to.not.be.undefined;
      expect(polyline.getSlopeTerrainMax()).to.not.be.undefined;
    });
  });
});
